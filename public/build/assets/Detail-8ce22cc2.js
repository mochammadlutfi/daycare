import{S as K}from"./SelectJenisKegiatan-800d220e.js";import{S as U}from"./SelectKegiatan-024db6f2.js";import{_ as I,m as w,o as c,e as g,w as i,f as r,t as L,p as a,K as d,a5 as y,j as D,g as v,S as Y,F as A,$ as P,q as N,u as O,v as R}from"./id-44e39273.js";import{E}from"./index-ada9f14f.js";import{E as q}from"./index-8d5cd002.js";import{E as z,a as G}from"./index-b7b101e9.js";import{E as Q,a as W}from"./index-aa7e31ad.js";import{a as X,E as Z}from"./index-88bb1aa7.js";import{E as $}from"./index-3fcc0242.js";import{E as ee}from"./index-f9851f1c.js";import{v as ae}from"./directive-cd218522.js";import"./typescript-defaf979.js";import"./index-4ea0d70f.js";import"./event-9519ab40.js";import"./index-05777cc1.js";import"./scroll-bd36456a.js";import"./vnode-eeb9e0f5.js";import"./_baseIteratee-982954bc.js";import"./_initCloneObject-24df7827.js";import"./index-9f983416.js";import"./isArrayLikeObject-b43587b5.js";import"./raf-3ca20a2c.js";import"./index-10bd6a9f.js";import"./panel-time-pick-f24324ab.js";import"./utils-d95efb42.js";const te={components:{SelectJenisKegiatan:K,SelectKegiatan:U},props:{hari:{type:Array},jadwal:{type:Object},errors:{type:Object}},computed:{},data(){return{isLoading:!1,formTitle:"Tambah Jadwal",showForm:!1,loadingForm:!1,editMode:!1,form:{id:null,jadwal_id:this.jadwal.id,hari:null,jenis_id:null,kegiatan_id:null,jam_mulai:null},data:[]}},async mounted(){await this.fetchData()},methods:{spanData(e){if(e.columnIndex===1)if(e.rowIndex===0||this.data[e.rowIndex].hari!==this.data[e.rowIndex-1].hari){let t=1;for(let s=e.rowIndex+1;s<this.data.length&&this.data[s].hari===e.row.hari;s++)t++;return{rowspan:t,colspan:1}}else return{rowspan:0,colspan:0}},makeRange(e,t){var s=[];for(let f=e;f<=t;f++)s.push(f);return s},disabledJamMulai(){return this.makeRange(0,6).concat(this.makeRange(17,23))},sortChange(e){this.sort=e.prop,this.sortDir=e.order=="ascending"?"ASC":"DESC",this.fetchData()},doSearch:_.debounce(function(){this.isLoading=!0,this.fetchData()},1e3),async fetchData(e){try{this.isLoading=!0;const t=await axios.get(this.route("admin.jadwal.detail.data",{id:this.jadwal.id}),{params:{}});t.status==200&&(this.data=t.data),this.isLoading=!1}catch(t){console.error(t)}},format_date(e){if(e)return moment(String(e)).format("DD MMMM YYYY")},onCloseForm(){this.title="Tambah Jadwal",this.editMode=!1,this.form.id=null,this.form.kelompok_id=null,this.form.jenis_id=null,this.form.kegiatan_id=null,this.form.hari=null,this.form.jam_mulai=null,this.form.jam_selesai=null,this.showForm=!1},submit(){this.loadingForm=!0;let e=this.$inertia.form(this.form),t=this.editMode==!0?this.route("admin.jadwal.detail.update",{id:this.jadwal.id,detail:this.form.id}):this.route("admin.jadwal.detail.store",{id:this.jadwal.id});e.post(t,{preserveScroll:!0,onFinish:()=>{this.loadingForm=!1,this.fetchData()},onSuccess:()=>{E({type:"success",message:"Data Berhasil Disimpan!"}),this.onCloseForm()}})},edit(e){this.formTitle="Ubah Jadwal",this.form.id=e.id,this.form.kelompok_id=e.kelompok_id,this.form.jenis_id=e.jenis_id,this.form.kegiatan_id=e.kegiatan_id,this.form.hari=e.hari,this.form.jam_mulai=e.jam_mulai,this.form.jam_selesai=e.jam_selesai,this.editMode=!0,this.showForm=!0},hapus(e){q.alert("Data yang dihapus tidak bisa dikembalikan!","Peringatan",{showCancelButton:!0,confirmButtonText:"Ya!",cancelButtonText:"Tidak!",type:"warning"}).then(()=>{this.$inertia.delete(this.route("admin.jadwal.detail.delete",{id:this.jadwal.id,detail:e}),{preserveScroll:!0,onSuccess:()=>{this.fetchData(),E({type:"success",message:"Data Berhasil Dihapus!"})}})})}}},oe={class:"content"},ie={class:"content-heading d-flex justify-content-between align-items-center"},le={class:"space-x-1"},se=r("i",{class:"fa fa-plus me-1"},null,-1),re={class:"block block-rounded"},ne={class:"block-content p-4"},me=r("i",{class:"fa fa-angle-down ms-1"},null,-1),de=r("i",{class:"si fa-fw si-note"},null,-1),ue=r("i",{class:"si fa-fw si-trash"},null,-1),ce={class:"text-end"},_e=r("i",{class:"fa fa-close me-2"},null,-1),fe=r("i",{class:"fa fa-check me-2"},null,-1);function pe(e,t,s,f,o,n){const p=P,m=z,k=N,x=O,V=R,C=G,F=w("select-jenis-kegiatan"),u=Q,S=w("select-kegiatan"),M=Z,J=X,b=$,T=W,B=ee,H=w("base-layout"),j=ae;return c(),g(H,null,{default:i(()=>[r("div",oe,[r("div",ie,[r("span",null,"Jadwal Kelompok "+L(s.jadwal.kelompok.nama),1),r("div",le,[a(p,{onClick:t[0]||(t[0]=l=>o.showForm=!0),type:"primary"},{default:i(()=>[se,d(" Tambah ")]),_:1})])]),y((c(),D("div",re,[r("div",ne,[a(C,{data:o.data,style:{width:"100%"},border:"","span-method":n.spanData},{default:i(()=>[a(m,{type:"index",width:"50"}),a(m,{prop:"hari",label:"Hari"}),a(m,{prop:"jenis.nama",label:"Jenis Kegiatan",width:"160"}),a(m,{prop:"kegiatan.nama",label:"Kegiatan"}),a(m,{prop:"kegiatan.tipe",label:"Tipe"}),a(m,{prop:"jam_mulai",label:"Jam Mulai"}),a(m,{prop:"jam_selesai",label:"Jam Selesai"}),a(m,{label:"Aksi",align:"center",width:"180"},{default:i(l=>[a(V,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:i(()=>[a(x,null,{default:i(()=>[a(k,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:v(h=>n.edit(l.row),["prevent"])},{default:i(()=>[d(" Ubah "),de]),_:2},1032,["onClick"]),a(k,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:v(h=>n.hapus(l.row.id,l.row.kelompok_id),["prevent"])},{default:i(()=>[d(" Hapus "),ue]),_:2},1032,["onClick"])]),_:2},1024)]),default:i(()=>[a(p,{type:"primary"},{default:i(()=>[d(" Aksi "),me]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data","span-method"])])])),[[j,o.isLoading]])]),y((c(),g(B,{modelValue:o.showForm,"onUpdate:modelValue":t[6]||(t[6]=l=>o.showForm=l),title:o.formTitle,width:"30%","before-close":n.onCloseForm},{default:i(()=>[a(T,{model:o.form,"label-position":"top"},{default:i(()=>[a(u,{label:"Jenis Kegiatan",error:s.errors.jenis_id},{default:i(()=>[a(F,{modelValue:o.form.jenis_id,"onUpdate:modelValue":t[1]||(t[1]=l=>o.form.jenis_id=l)},null,8,["modelValue"])]),_:1},8,["error"]),a(u,{label:"Kegiatan",error:s.errors.kegiatan_id},{default:i(()=>[a(S,{modelValue:o.form.kegiatan_id,"onUpdate:modelValue":t[2]||(t[2]=l=>o.form.kegiatan_id=l),disabled:!o.form.jenis_id,hasParent:"",jenis:o.form.jenis_id},null,8,["modelValue","disabled","jenis"])]),_:1},8,["error"]),a(u,{label:"Hari",error:s.errors.usia},{default:i(()=>[a(J,{modelValue:o.form.hari,"onUpdate:modelValue":t[3]||(t[3]=l=>o.form.hari=l),placeholder:"Pilih",class:"w-100"},{default:i(()=>[(c(!0),D(A,null,Y(s.hari,(l,h)=>(c(),g(M,{key:h,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),a(u,{label:"Jam",error:s.errors.jam_mulai},{default:i(()=>[a(b,{class:"w-100",format:"HH:mm","value-format":"HH:mm:ss",modelValue:o.form.jam_mulai,"onUpdate:modelValue":t[4]||(t[4]=l=>o.form.jam_mulai=l),"disabled-hours":n.disabledJamMulai},null,8,["modelValue","disabled-hours"])]),_:1},8,["error"]),a(u,{label:"Jam",error:s.errors.jam_selesai},{default:i(()=>[a(b,{class:"w-100",format:"HH:mm","value-format":"HH:mm:ss",modelValue:o.form.jam_selesai,"onUpdate:modelValue":t[5]||(t[5]=l=>o.form.jam_selesai=l),"disabled-hours":n.disabledJamMulai},null,8,["modelValue","disabled-hours"])]),_:1},8,["error"]),r("div",ce,[a(p,{onClick:n.onCloseForm},{default:i(()=>[_e,d(" Batal ")]),_:1},8,["onClick"]),a(p,{type:"primary",onClick:n.submit},{default:i(()=>[fe,d(" Simpan ")]),_:1},8,["onClick"])])]),_:1},8,["model"])]),_:1},8,["modelValue","title","before-close"])),[[j,o.loadingForm]])]),_:1})}const Ae=I(te,[["render",pe]]);export{Ae as default};

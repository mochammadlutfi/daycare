import{_ as T,K as U,m as j,o as f,e as _,w as o,f as a,t as v,p as t,L as m,a6 as D,g as x,a0 as L,q as N,u as z,v as Y}from"./id-97c9e5f5.js";import{h as A}from"./moment-fbc5633a.js";import{E as g}from"./index-1919b3f8.js";import{E as H}from"./index-d0506f46.js";import{E as O,a as P}from"./index-bcb34dd7.js";import{E as q,a as R}from"./index-1567bcf2.js";import{E as G}from"./index-ae963a16.js";import{E as J,a as Q}from"./index-ec964314.js";import{E as W}from"./index-de85108f.js";import{E as X,a as Z}from"./index-4f1c3644.js";import{E as $}from"./index-56cc5e45.js";import{v as ee}from"./directive-7739a56c.js";import"./typescript-defaf979.js";import"./index-01cbe581.js";import"./scroll-1fa1a40e.js";import"./vnode-4e97093f.js";import"./index-4a89f490.js";import"./event-9519ab40.js";import"./index-91a35dc4.js";import"./_initCloneObject-9298e566.js";import"./_baseIteratee-2fd9a4cf.js";import"./isArrayLikeObject-55c2e828.js";import"./raf-85a89f42.js";const te={props:{group:Object,errors:Object},data(){return{selected:[],data:[],isLoading:!0,page:1,pageSize:0,searchKey:"name",searchKeyword:"",limit:25,total:0,showForm:!1,sort:"name",sortDir:"ASC",formTitle:"Tambah Kontak "+this.group.name,form:{id:null,name:null,phone:null,group_id:this.group.id},editMode:!1,loadingForm:!1,showImport:!1,importFile:null,loadingImport:!1}},async created(){await this.fetchData()},methods:{indexMethod(i){return(this.page==1?1:this.limit*(this.page-1)+1)+i},sortChange(i){this.sort=i.prop,this.sortDir=i.order=="ascending"?"ASC":"DESC",this.fetchData()},async fetchData(e){var e=e??1;try{this.isLoading=!0;const r=await U.get(this.route("admin.contact.data"),{params:{page:e,limit:this.limit,sort:this.sort,sortDir:this.sortDir,search:this.searchKeyword,searchKey:this.searchKey,group_id:this.group.id}});r.status==200&&(this.data=r.data.data,this.page=r.data.current_page,this.total=r.data.total,this.pageSize=r.data.per_page),this.isLoading=!1}catch(r){console.error(r)}},format_date(i){if(i)return A(String(i)).format("DD MMMM YYYY")},onCloseForm(){this.title="Tambah Kontak "+this.group.name,this.editMode=!1,this.form.id=null,this.form.name=null,this.form.phone=null,this.showForm=!1},submit(){this.loadingForm=!0;let i=this.$inertia.form(this.form),e=this.editMode==!0?this.route("admin.contact.update",{id:this.form.id}):this.route("admin.contact.store");i.post(e,{preserveScroll:!0,onFinish:()=>{this.loadingForm=!1,this.fetchData()},onSuccess:()=>{g({type:"success",message:"Data Berhasil Disimpan!"}),this.onCloseForm()}})},edit(i){this.formTitle="Ubah Kontak "+this.group.name,this.form.id=i.id,this.form.name=i.name,this.form.phone=i.phone,this.editMode=!0,this.showForm=!0},hapus(i){H.alert("Data yang dihapus tidak bisa dikembalikan!","Peringatan",{showCancelButton:!0,confirmButtonText:"Ya!",cancelButtonText:"Tidak!",type:"warning"}).then(()=>{this.$inertia.delete(this.route("admin.contact.delete",{id:i}),{preserveScroll:!0,onSuccess:()=>{this.fetchData(),g({type:"success",message:"Data Berhasil Dihapus!"})}})})},doImport(){this.loadingImport=!0;let i=this.$inertia.form({file:this.importFile,group_id:this.group.id}),e=this.route("admin.contact.import");i.post(e,{preserveScroll:!0,onFinish:()=>{this.loadingImport=!1,this.fetchData(),this.onCloseImport},onSuccess:()=>{g({type:"success",message:"Data Berhasil Disimpan!"}),this.onCloseForm()}})},onCloseImport(){this.showImport=!1,this.importFile=null},selectFiles(i){var e=i.target.files||i.dataTransfer.files;e.length&&(this.importFile=i.target.files[0])}}},oe={class:"content"},se={class:"content-heading d-flex justify-content-between align-items-center"},le={class:"space-x-1"},ae=a("i",{class:"si si-plus me-1"},null,-1),ie=a("i",{class:"fa fa-upload me-1"},null,-1),ne={class:"block block-rounded"},re={class:"block-content py-3"},me=a("i",{class:"fa fa-search"},null,-1),de={class:"block-content p-0"},ce=a("i",{class:"fa fa-angle-down ms-1"},null,-1),pe=a("i",{class:"si fa-fw si-note"},null,-1),ue=a("i",{class:"si fa-fw si-trash"},null,-1),he={class:"block-content py-2"},fe={class:"row justify-content-end"},_e={class:"col-md-6 text-end"},ge={class:"text-end"},we=a("i",{class:"si si-close me-1"},null,-1),be=a("i",{class:"si si-check me-1"},null,-1),ke={class:"text-end"},ye=a("i",{class:"si si-close me-1"},null,-1),Ce=a("i",{class:"si si-check me-1"},null,-1);function ve(i,e,r,De,s,n){const d=L,p=O,E=P,w=q,u=G,F=R,c=J,b=N,V=z,I=Y,S=Q,K=W,h=X,k=Z,y=$,M=j("base-layout"),C=ee;return f(),_(M,null,{default:o(()=>[a("div",oe,[a("div",se,[a("span",null,"List Kontak "+v(r.group.name),1),a("div",le,[t(d,{onClick:e[0]||(e[0]=l=>s.showForm=!0),type:"primary"},{default:o(()=>[ae,m(" Tambah Kontak ")]),_:1}),t(d,{onClick:e[1]||(e[1]=l=>s.showImport=!0),type:"primary"},{default:o(()=>[ie,m(" Import Kontak ")]),_:1})])]),a("div",ne,[a("div",re,[t(F,{justify:"space-between"},{default:o(()=>[t(w,{span:12},{default:o(()=>[t(E,{modelValue:s.limit,"onUpdate:modelValue":e[2]||(e[2]=l=>s.limit=l),placeholder:"Pilih",style:{width:"115px"},onChange:e[3]||(e[3]=l=>n.fetchData(1))},{default:o(()=>[t(p,{label:"25",value:"25"}),t(p,{label:"50",value:"50"}),t(p,{label:"100",value:"100"})]),_:1},8,["modelValue"])]),_:1}),t(w,{span:8},{default:o(()=>[t(u,{modelValue:s.searchKeyword,"onUpdate:modelValue":e[5]||(e[5]=l=>s.searchKeyword=l),placeholder:"Masukan kata kunci",class:"input-with-select",clearable:""},{append:o(()=>[t(d,{onClick:e[4]||(e[4]=l=>n.fetchData(1))},{default:o(()=>[me]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),a("div",de,[D((f(),_(S,{data:s.data,class:"table-click",style:{width:"100%"},onSortChange:n.sortChange},{default:o(()=>[t(c,{type:"index",index:n.indexMethod,width:"100"},null,8,["index"]),t(c,{prop:"name",label:"Nama",sortable:""}),t(c,{prop:"phone",label:"No Handphone",sortable:""}),t(c,{label:"Dibuat"},{default:o(l=>[m(v(n.format_date(l.row.created_at)),1)]),_:1}),t(c,{label:"Aksi",align:"center",width:"180"},{default:o(l=>[t(I,{"popper-class":"dropdown-action",trigger:"click"},{dropdown:o(()=>[t(V,null,{default:o(()=>[t(b,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:x(B=>n.edit(l.row),["prevent"])},{default:o(()=>[m(" Ubah "),pe]),_:2},1032,["onClick"]),t(b,{class:"d-flex align-items-center justify-content-between space-x-1",onClick:x(B=>n.hapus(l.row.id),["prevent"])},{default:o(()=>[m(" Hapus "),ue]),_:2},1032,["onClick"])]),_:2},1024)]),default:o(()=>[t(d,{type:"primary"},{default:o(()=>[m(" Aksi "),ce]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data","onSortChange"])),[[C,s.isLoading]])]),a("div",he,[a("div",fe,[a("div",_e,[t(K,{class:"float-end",background:"",layout:"prev, pager, next","page-size":s.pageSize,total:s.total,"current-page":s.page,onCurrentChange:n.fetchData},null,8,["page-size","total","current-page","onCurrentChange"])])])])])]),t(y,{modelValue:s.showForm,"onUpdate:modelValue":e[8]||(e[8]=l=>s.showForm=l),title:s.formTitle,width:"30%",class:"rounded-2","before-close":n.onCloseForm},{default:o(()=>[t(k,{model:s.form,"label-position":"top"},{default:o(()=>[t(h,{label:"Nama Kontak"},{default:o(()=>[t(u,{modelValue:s.form.name,"onUpdate:modelValue":e[6]||(e[6]=l=>s.form.name=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(h,{label:"No Handphone"},{default:o(()=>[t(u,{modelValue:s.form.phone,"onUpdate:modelValue":e[7]||(e[7]=l=>s.form.phone=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a("div",ge,[t(d,{onClick:n.onCloseForm},{default:o(()=>[we,m(" Batal ")]),_:1},8,["onClick"]),t(d,{"native-type":"submit",type:"primary",onClick:n.submit},{default:o(()=>[be,m(" Simpan ")]),_:1},8,["onClick"])])]),_:1},8,["model"])]),_:1},8,["modelValue","title","before-close"]),t(y,{modelValue:s.showImport,"onUpdate:modelValue":e[11]||(e[11]=l=>s.showImport=l),title:"Import Kontak",width:"30%",class:"rounded-2","before-close":n.onCloseImport,"close-on-click-modal":!1},{default:o(()=>[D((f(),_(k,{"label-position":"top"},{default:o(()=>[t(h,{label:"File",error:r.errors.file},{default:o(()=>[a("input",{type:"file",class:"file-input",onChange:e[9]||(e[9]=(...l)=>n.selectFiles&&n.selectFiles(...l)),accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},null,32)]),_:1},8,["error"]),a("div",ke,[t(d,{class:"ml-3",onClick:e[10]||(e[10]=l=>s.showImport=!1)},{default:o(()=>[ye,m(" Batal ")]),_:1}),t(d,{class:"ml-3",type:"primary",onClick:n.doImport},{default:o(()=>[Ce,m(" Upload ")]),_:1},8,["onClick"])])]),_:1})),[[C,s.loadingImport]])]),_:1},8,["modelValue","before-close"])]),_:1})}const Je=T(te,[["render",ve]]);export{Je as default};
